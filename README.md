# Домашнее задание к занятию "`12-04hw`" - `Ливчак Сергей`

---

### Задание 1

`Приведите ответ в свободной форме........`

1. `Заполните здесь этапы выполнения, если требуется ....`
2. `Заполните здесь этапы выполнения, если требуется ....`
3. `Заполните здесь этапы выполнения, если требуется ....`
4. `Заполните здесь этапы выполнения, если требуется ....`
5. `Заполните здесь этапы выполнения, если требуется ....`
6. 

```
SELECT CONCAT(staff.first_name, ' ',  staff.last_name), city.city, COUNT(customer.store_id)
FROM staff
INNER JOIN store ON staff.store_id = store.store_id 
INNER JOIN address ON store.address_id = address.address_id 
INNER JOIN city ON city.city_id = address.city_id 
INNER JOIN customer ON customer.store_id = staff.store_id
GROUP BY staff_id
HAVING COUNT(customer.store_id) > 300;
```

1. **12-04hw-1** 
<img src = "img/12-04hw-1-1.png" width = 80%>


---

### Задание 2

`Получите количество фильмов, продолжительность которых больше средней продолжительности всех фильмов.`
 

```
SELECT COUNT(*)
FROM film_list
WHERE film_list.length > (SELECT AVG(length) FROM film_list);

```

1. **12-04hw-2** 
<img src = "img/12-04hw-2-1.png" width = 80%>

---

### Задание 3

`Получите информацию, за какой месяц была получена наибольшая сумма платежей, и добавьте информацию по количеству аренд за этот месяц.`

1. `Выделяем оператором MONTH из datatime месяц`
2. `Суммируем оплаты `
3. `Добавляем счётчик строк аренды`
4. `Группируем по месячной оплате`
5. `Ограничиваем вывод сортировки по сумме до 1 в порядке по убыванию суммы платежей`

```
SELECT MONTH(payment_date), SUM(amount), COUNT(payment_id)
FROM payment
GROUP BY MONTH(payment_date)
ORDER BY SUM(amount) DESC
LIMIT 1;

```

`При необходимости прикрепитe сюда скриншоты
![Название скриншота](ссылка на скриншот)`

### Задание 4

`Приведите ответ в свободной форме........`

1. `Заполните здесь этапы выполнения, если требуется ....`
2. `Заполните здесь этапы выполнения, если требуется ....`
3. `Заполните здесь этапы выполнения, если требуется ....`
4. `Заполните здесь этапы выполнения, если требуется ....`
5. `Заполните здесь этапы выполнения, если требуется ....`
6. 

```
Поле для вставки кода...
....
....
....
....
```

`При необходимости прикрепитe сюда скриншоты
![Название скриншота](ссылка на скриншот)`

---
## Дополнительные задания (со звездочкой*)

Эти задания дополнительные (не обязательные к выполнению) и никак не повлияют на получение вами зачета по этому домашнему заданию. Вы можете их выполнить, если хотите глубже и/или шире разобраться в материале.

### Задание 5

`Приведите ответ в свободной форме........`

1. `Заполните здесь этапы выполнения, если требуется ....`
2. `Заполните здесь этапы выполнения, если требуется ....`
3. `Заполните здесь этапы выполнения, если требуется ....`
4. `Заполните здесь этапы выполнения, если требуется ....`
5. `Заполните здесь этапы выполнения, если требуется ....`
6. 

`При необходимости прикрепитe сюда скриншоты
![Название скриншота](ссылка на скриншот)`
